<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    
    <link rel="stylesheet" type="text/css" href="./form_style.css">

    <title>Registration page</title>
  </head>
  <body onload="validate()">
  	<div class="centered-content">
    <h2>Please register below:</h2>
    
    <div class="input-line">
    <label for="username">Username:</label>    
    <input
    id="username" 
    name="username"
    title="Your username, no more than 15 characters"
    maxlength="15"
    type="text"
    required="required"
    aria-required="true"    
    onchange="validate()"    
    ></input>  
    <p class="error-message" hidden id="username_error"></p>  
    </div>
    
    <div class="input-line">
    <label for="email">Email:</label>    
    <input
    id="email" 
    name="email"
    title="Your email"
    type="email"
    required="required"
    aria-required="true"    
    onchange="validate()"
    ></input>
    <p class="error-message" hidden id="email_error"></p>
    </div>
    
    <div class="input-line">
    <label>Password:</label>    
    <input
    id="password" 
    name="password"
    title="Your password"
    type="password"
    required="required"
    aria-required="true"    
    onchange="validate()"
    ></input>
    <p class="error-message" hidden id="password_error"></p>
    </div>

	<div class="input-line">
	<label>Confirm Password:</label>	
    <input
    id="confirm" 
    name="confirm"
    title="Please reenter your password"
    type="password"
    required="required"
    aria-required="true"    
    onchange="validate()"
    ></input>
    <p class="error-message" hidden id="confirm_error"></p>
    </div>
    
    <div class="input-line">
    <button disabled id="submit" onclick="submit()">Submit</button>
    </div>
    
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script>
    const usernameInput = document.getElementById('username');
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    const confirmInput = document.getElementById('confirm');
    
    function validate() {
    	
    	var isValid = true;
    	    	
       	if ( (usernameInput.value.length > 1) && (usernameInput.value.length <= 15) ) {       		
       		document.getElementById('username_error').innerHTML = ("");  
       		document.getElementById('username_error').setAttribute("hidden", "true");
       	} else if (usernameInput.value.length > 15) {
       		document.getElementById('username_error').innerHTML = ("Username must be no more than 15 characters");
       		document.getElementById('username_error').removeAttribute("hidden");
       		isValid = false;
       	} else if (usernameInput.value.length < 1) {
       		document.getElementById('username_error').innerHTML = ("Username required");
       		document.getElementById('username_error').removeAttribute("hidden");
       		isValid = false;
       	} else {
       		document.getElementById('username_error').innerHTML = ("Invalid Username");
       		document.getElementById('username_error').removeAttribute("hidden");
       		isValid = false;
       	}
    	
    	var emailPattern = /(?:[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/
    	let emailRegEx = new RegExp(emailPattern);
    	if ( emailRegEx.test(emailInput.value) ) {
    		document.getElementById('email_error').innerHTML = ("");  
       		document.getElementById('email_error').setAttribute("hidden", "true");
    	} else if (emailInput.value) {
    		document.getElementById('email_error').innerHTML = ("Invalid Email");
       		document.getElementById('email_error').removeAttribute("hidden");
       		isValid = false;       		
    	} else {
    		document.getElementById('email_error').innerHTML = ("Email address required");
       		document.getElementById('email_error').removeAttribute("hidden");
       		isValid = false;
    	}    	   	
    	
    	if (passwordInput.value) {
    		document.getElementById('password_error').innerHTML = ("");  
       		document.getElementById('password_error').setAttribute("hidden", "true");
    	} else {
    		document.getElementById('password_error').innerHTML = ("Password required");
       		document.getElementById('password_error').removeAttribute("hidden");
       		isValid = false;
    	} 
    	
    	if (confirmInput.value) {
    		document.getElementById('confirm_error').innerHTML = ("");  
       		document.getElementById('confirm_error').setAttribute("hidden", "true");
    	} else {
    		document.getElementById('confirm_error').innerHTML = ("Please reenter password");
       		document.getElementById('confirm_error').removeAttribute("hidden");
       		isValid = false;
    	} 
    	
    	if ( passwordInput.value && confirmInput.value)
    	{
	    	if ( passwordInput.value == confirmInput.value ) {
	    		document.getElementById('confirm_error').innerHTML = ("");  
	       		document.getElementById('confirm_error').setAttribute("hidden", "true"); 
	       	} else {
	       		document.getElementById('confirm_error').innerHTML = ("Passwords do not match");
	       		document.getElementById('confirm_error').removeAttribute("hidden");
	       		isValid = false;       		
	       	}
    	}
    	
    	if (isValid) {
    		document.getElementById('submit').removeAttribute("disabled")
    	}
    	else {
    		document.getElementById('submit').setAttribute("disabled", "true");
    	}
	     	
    } 
    
    function submit() {
    	  alert("Submitted!");
    	}
    </script>
  </body>
</html>
